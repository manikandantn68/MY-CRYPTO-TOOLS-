# Function to compute the integer e-th root of a large number using binary search
def int_root(c, e):
    low, high = 0, c
    while low <= high:
        mid = (low + high) // 2
        power = pow(mid, e)
        if power == c:
            return mid, True  # Exact root found
        elif power < c:
            low = mid + 1
        else:
            high = mid - 1
    return high, pow(high, e) == c  # Return closest integer root and check if exact

# Given values
e = 20  # Public exponent
C = 640637430810406857500566702096274084238635318236179213474171471762962924031143406771762588590902396470755916529600404366017178856626504741264100246977770193177982321362431635239123331391332283310413781431317549724468046316011302717443301165248044916895605360942507583028357810072669019236437156021816483243897608716222651423340065746814875027190173089290179247176013883045798188232610328606575842929711953488636313111201073364434975416304861734107255474444898256437810232659581724786888468502454545178277401729068994688903655623034819685425430186901945673259366517562372649145103691296871839480367338134748035927612049747953193375204813837077096417935374925353519278729502554398818207750243092444833079944911226317963218327666226602587092863946963826671637061083175873944168270391171031158543469061673239737214705264979925667174942748269782844201684882259905429257929174592217288529234346005812956484839757692101317938929998836230049852549655586558526707728788020998340767097021929454867673939894353379731654252811545277025372592862223748563679444476115932107120123555249896845005062698950234571360385178811724060146325198188855919677023470832794001

# Step 1: Compute the integer root
root, exact = int_root(C, e)

# Step 2: Check if the root is exact
if not exact:
    print("Not found")  # The ciphertext wasn't a perfect e-th power
else:
    print(root)  # Print the recovered integer root (plaintext as a number)

    # Step 3: Convert the integer to bytes
    byte_data = root.to_bytes((root.bit_length() + 7) // 8, 'big')
    print(byte_data)  # Print the raw byte representation

    # Step 4: Decode the bytes into a readable string (assuming UTF-8 encoding)
    print(byte_data.decode())  # Print the decoded message

