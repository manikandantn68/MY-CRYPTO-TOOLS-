import binascii
import owiener

# Public key components
e = 29701486310587164030535489851375135003798758759561984508455050588716882718408186108807934300972705311696691935349221068116267565916007108677423883521992192319334351204769159842057350627396953980810714575222149433616460825895669370240735644454156617825897287247683590893041302087476866985335429632119541439373
n = 105381798356588651060322160187502348403068288481412224619745861845587732733302713041409536971244035062584183122487572950093799950547443470139597161725188868250796417283454608268983499378770380202303307751513327336431447155013287484078234113269394120883243400365274262143996620217899482070863844644485693590987
c = 102839302225988153666561668393607455553166770136716238700648148962970961392433492703382012880164000095417840209794830514165754603946129787294555662146596313444756580514823349128390474097808922974822268118219361428524059303119587335969689226541987663213889705325071610876957747879519215839783143311347596383225

# Attempt Wiener's attack
d = owiener.attack(e, n)

if d is None:
    print("‚ùå Failed to recover the private key.")
else:
    print(f"‚úÖ Hacked private key d = {d}")

    # Decrypt the ciphertext
    m = pow(c, d, n)
    flag_hex = "{:x}".format(m)
    if len(flag_hex) % 2 != 0:
        flag_hex = "0" + flag_hex

    try:
        flag = binascii.unhexlify(flag_hex).decode()
    except UnicodeDecodeError:
        flag = binascii.unhexlify(flag_hex).decode('latin1')

    print("üéØ Decrypted message:", flag)
